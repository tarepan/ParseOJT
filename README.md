<div align="center">

# ğŸ’¬ SpeechTree ğŸŒ² <!-- omit in toc -->

Represent speech text with simple-but-rich tree structure, Convert from/to popular TTS formats.  
æ§˜ã€…ãª TTS ã‚’ã¤ãªãã€ã‚·ãƒ³ãƒ—ãƒ«ã‹ã¤ãƒªãƒƒãƒãªæœ¨æ§‹é€ ã®éŸ³å£°ãƒ†ã‚­ã‚¹ãƒˆã€‚

</div>

```python
ojt = openjtalk.run_frontend("ç›¸äº’é‹ç”¨æ€§ã£ã¦è‰¯ã„ã‚ˆã­ã€‚")
tree = parse_ojt_features(ojt)
vv = parse_as_voicevox(tree)  # Use it for speech synthesis by VOICEVOX API ğŸ‰
graph = parse_as_graph(tree)  # Beautiful graph, see below âœ¨ï¸
```

[graph]

```mermaid
graph TD;
    A["Open JTalk NJD features"] --> B["Tree"];
    B --> C["VOICEVOX AccentPhrases"];
    B --> D["visual graph"];
```

## Dev
### All-in Check
```bash
## check-and-fix
uv run mypy . && uv run ruff check --fix && uv run ruff format && uv run typos && uv run pytest
```

### All-in Static Program Analysis
```bash
# check-only
uv run mypy . && uv run ruff check && uv run ruff format --check && uv run typos

## check-and-fix
uv run mypy . && uv run ruff check --fix && uv run ruff format && uv run typos
```

### Design Docs
Open JTalk `make_label()` ç³»ï¼ˆNJD ã®ãƒ‘ãƒ¼ã‚µãƒ¼ã¨ãã®å‡ºåŠ›è¡¨ç¾ï¼‰ãŒå†…éƒ¨ã§ã©ã‚“ãªå‡¦ç†ã‚’ã—ã¦ã„ã‚‹ã‹ã€web ä¸Šã«æƒ…å ±ãŒã»ã¼ãªã„ã€‚  
NJD ãƒ‘ãƒ¼ã‚µãƒ¼ã¨ãã®å‡ºåŠ›è¡¨ç¾ã‚’ã€ã‚ˆã‚Šãƒ¢ãƒ€ãƒ³ãªè¨€èªã§å®Ÿè£…ã—ã¦æ•´ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚  

ãƒ•ãƒ«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ©ãƒ™ãƒ«ã¯æƒ…å ±ãŒä¸è¶³ã—ã¦ã„ã‚‹ã€‚è¡¨å±¤å½¢ã®æƒ…å ±ã‚’æ„å›³çš„ã«è½ã¨ã—ã¦ã„ã‚‹ãŸã‚ã€å˜èªã¨éŸ³ç´ ã®å¯¾å¿œãŒå–ã‚Œãªã„ã€‚  
editable ãª TTS ã‚’ã¤ãã‚‹ã«ã¯ãƒ•ãƒ«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ©ãƒ™ãƒ«ã¯å½¹ä¸è¶³ã§ã‚ã‚Šã€æ–°ã—ã„è¦æ ¼ãŒå¿…è¦ã§ã‚ã‚‹ã€‚  

Open JTalk `make_label()` ç³»ã¯ NJDNode ã‚’ JPCommonNode ã¸å¤‰æ›ã—ã¦ãŠã‚Šã€ã“ã®æ™‚ç‚¹ã§è¡¨å±¤å½¢ã®æƒ…å ±ã‚’æ„å›³çš„ã«è½ã¨ã—ã¦ã„ã‚‹ã€‚  
ã¤ã¾ã‚Šã€`make_label()` ç³»ã®ãƒ¢ãƒ€ãƒ³å†å®Ÿè£…ã‚’ã—ã¦ã‚‚æƒ…å ±ä¸è¶³ã¯è§£æ±ºã—ãªã„ã€‚  

ãã®ãŸã‚ã€`make_label()` ç³»ã®ç¾è¡ŒæŒ™å‹•ã‚’ç†è§£ã—ãŸã†ãˆã§ã€è¡¨å±¤å½¢ã‚’ä¿æŒã™ã‚‹ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒƒãƒˆçš„ãªãƒ‘ãƒ¼ã‚µãƒ¼ãƒ»å‡ºåŠ›è¡¨ç¾ã‚’æ–°ã—ãææ¡ˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚  

ä½œã‚ŠãŸã„ã‚‚ã®ã¯ã€Œeditable ãªéŸ³å£°åˆæˆã«ãŠã‘ã‚‹ã€ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†ã®æœ€çµ‚å‡ºåŠ›è¡¨ç¾ã€ã§ã‚ã‚‹ã€‚  
ãƒ†ã‚­ã‚¹ãƒˆã«è©±è€…æ€§ã¯ãªã„ã®ã§ã€ã“ã®è¡¨ç¾ã«ã‚‚è©±è€…æ€§ã¯æŒãŸã›ãªã„ã€‚ãã®ãŸã‚éŸ³ã®é•·ã•ã‚„é«˜ã•ã¯ä¸è¦ã€‚  
åŸºæœ¬çš„ã«è©±è€…éä¾å­˜ã§ã‚ã‚‹ã€Œç™ºéŸ³ã€ã€Œã‚¢ã‚¯ã‚»ãƒ³ãƒˆã€ã€Œè¨˜å·ã‚¤ãƒ³ãƒˆãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆï¼ã‚„ï¼Ÿï¼‰ã€ãŒåˆæˆå‘ã‘ã«é‡è¦ã€‚  
ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†ã®ä¸­é–“å‡ºåŠ›ã§ãªãæœ€çµ‚å‡ºåŠ›ã§ã‚ã‚‹ãŸã‚ã€çŸ­å˜ä½ã®è‡ªå‹•çµåˆã‚„å“è©ã‚’ç”¨ã„ãŸè‡ªå‹•ã‚¢ã‚¯ã‚»ãƒ³ãƒˆæ¨å®šã¯å®Œäº†ã—ãŸå‰æã€‚ãã®ãŸã‚å“è©ã‚„æ´»ç”¨ã¯ä¸è¦ã€‚  
ã¾ãŸ editable ã«ã™ã‚‹ãŸã‚ã€ç™ºéŸ³ã‚„ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã®ä¿®æ­£ãŒå¿…è¦ã€‚ãã®ãŸã‚ã«ã¯å¤§å…ƒã¨ãªã‚‹è¡¨å±¤å½¢ã¨ãã®å¯¾å¿œä»˜ã‘ãŒå¿…è¦ã€‚ã˜ã‚ƒãªã„ã¨ã€Œä½•ãŒé–“é•ã£ã¦ã„ã‚‹ã‹ã€ã®ã€Œä½•ãŒã€ã‚’ç‰¹å®šã§ããªã„ã€‚  
å‰æ®µã§ã¯ã€Œè¾æ›¸è¡¨å±¤å½¢ã¨ãƒ†ã‚­ã‚¹ãƒˆã®ä¸€è‡´æ¤œç´¢ & æœ€é©ç³»åˆ—é¸æŠã€ãŒåŸºç¤ã¨ãªã£ã¦ç™ºéŸ³ãŒä¸ãˆã‚‰ã‚Œã‚‹ã¨æƒ³å®šã™ã‚‹ï¼ˆä¾‹: MeCabï¼‰ãŸã‚ã€è¾æ›¸ã®ã€Œèª/ãƒ¯ãƒ¼ãƒ‰ã€ãŒåŸºæº–ãƒ¦ãƒ‹ãƒƒãƒˆã€‚  
ãƒ¯ãƒ¼ãƒ‰ã«è¡¨å±¤å½¢ã¨ç™ºéŸ³ãŒãã£ã¤ãå½¢ã€‚ç™ºéŸ³ã¯ãƒ¢ãƒ¼ãƒ©åˆ—ã¸ä¸€æ„ã«å¤‰æ›ã§ãã‚‹ã®ã§ã€ãƒ¢ãƒ¼ãƒ©åˆ—ã¨ã—ã¦ä¿æŒã•ã‚Œã‚‹ã€‚  

éŸ³å£°åˆæˆãŒç›®çš„ã§ã‚ã£ã¦ã€ãƒ†ã‚­ã‚¹ãƒˆåˆ†æãŒç›®çš„ã§ã¯ãªã„ã“ã¨ã«æ³¨æ„ã€‚  
ãªã®ã§è¡¨å±¤å½¢ã¯å¤§äº‹ã ãŒã€åŸºæœ¬å½¢ã¯é‡è¦ã§ã¯ãªã„ã€‚  

TTS ãŒå‰æã§ã‚ã‚‹ãŸã‚ã€ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æ–‡å­—çš„ã«éŸ³ã‚’æŒ‡å®šã™ã‚‹ã€‚  
ã‚ˆã‚Šå…·ä½“çš„ã«ã¯ã€ç™ºéŸ³ã‚’ï¼ˆéŸ³ç´ ã‚„å˜éŸ³ã§ãªãï¼‰ã‚«ã‚¿ã‚«ãƒŠã§æŒ‡å®šã™ã‚‹ã€‚  
ã“ã‚Œã¯ä¸€èˆ¬çš„ãªæ—¥æœ¬äººã®æ„Ÿè¦šã§ã¯ä»®åãŒéŸ³ã®åŸå­ã§ã‚ã‚‹ãŸã‚ã€‚  
ãã®ãŸã‚æ—¥æœ¬äººãŒç™ºéŸ³ã¨ã—ã¦å—ã‘å…¥ã‚Œã‚‰ã‚Œã‚‹ã‚«ã‚¿ã‚«ãƒŠè¡¨è¨˜ã¯å…¨ã¦ã‚«ãƒãƒ¼ã™ã‚‹ã®ãŒå¥½ã¾ã—ã„ã€‚  
ã‚«ã‚¿ã‚«ãƒŠã¨éŸ³ç´ ã®å¯¾å¿œãŒ 1:1 ã‹ã¯ã‚ã‹ã‚‰ãªã„ã€‚ãƒ¬ã‚¢ãªã‚«ã‚¿ã‚«ãƒŠè¡¨è¨˜ï¼ˆä¾‹: ãƒ´ãƒ£ï¼‰ãŒæ¨™æº–çš„ãªã‚«ã‚¿ã‚«ãƒŠè¡¨è¨˜ï¼ˆãƒ“ãƒ£ï¼‰ã¨åŒã˜éŸ³ç´ ã¨ã„ã†å¯èƒ½æ€§ã‚‚ã‚ã‚‹ã€‚ãã®è¾ºã¯å€‹äººå·®ãŒãƒ‡ã‚«ãã¦æ¨™æº–åŒ–å›°é›£ã‹ã‚‚ã—ã‚Œãªã„ã€‚  
ã“ã®ç‚¹ã‚‚è€ƒãˆã‚‹ã¨ã€ãƒ¢ãƒ¼ãƒ©ã¨éŸ³ç´ ãŒåˆ¥ãƒ¬ã‚¤ãƒ¤ãƒ¼ãªã®ã‚‚ä¸€ç†ãŒã‚ã‚‹ã€‚  
ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’è¨­å®šå€¤ã¨ã—ã¦å¤–ã«å‡ºã™ã®ã‚‚æ‰‹ã€‚ã²ã¨ã¾ãšã¯ OJT æº–æ‹ ã¨ã™ã‚‹ã€‚  
ãªãŠã€ã‚‚ã£ã¨ç´°ã‹ãã—ãŸã„ãªã‚‰å˜éŸ³ã‚’éŸ³ç´ ã®ä¸‹ã«ç½®ã‘ã°è‰¯ã„ã€‚ç•°éŸ³ã‚’ãã£ã¡ã‚Šåˆ†ã‘ã‚‰ã‚Œã‚‹ã€‚ãŒã€ç¾è¡Œã§éŸ³ç´ â†’å˜éŸ³ã‚’é©åˆ‡ã«æ¨å®šã™ã‚‹æ‰‹æ³•ã¯å¯¡èã«ã—ã¦çŸ¥ã‚‰ãªã„ã€‚  

å‹ã¯ str ã§è‡ªç”±ã«ã—ã¦ã€validator ã§ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã¨ã„ã†ã®ã‚‚æ‰‹ã€‚ãã†ã™ã‚Œã° validator ã® rule ã‚’è¨­å®šå€¤ã§å¤‰ãˆã‚‰ã‚Œã‚‹ã€‚  
tree ã‚’åˆæˆã«åˆ©ç”¨ã™ã‚‹ã¨ãã¯ã©ã†ã›åˆæˆå™¨ã«åˆã‚ã›ã¦ converter ã‚’æ›¸ãã®ã§ã€ãã®æ™‚ã«ãã®åˆæˆå™¨ã«åˆã‚ã›ãŸ validator ã‚’æ›ã‘ã‚Œã°è‰¯ã„ã€‚

class TreeManager (ã‹ã‚ªã‚·ãƒ£ãƒ¬ã« Gardener) ã‚’ç”¨æ„ã—ã¦ã€ãã“ã« validator ã‚„ replacer ã‚’ã‚‚ãŸã›ã‚‹ã®ã¯æœ‰ã‚Šã€‚  
Tree è‡ªä½“ã¯ã‚³ãƒ³ãƒ†ãƒŠè¦æ ¼ãªã®ãŒå¤§äº‹ã§ã€ç‹¬è‡ªã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ Tree ã‚’ä½œã£ã¦ã‚‚ã‚‰ã†ã®ã¯ä¸€å‘ã«æ§‹ã‚ãªã„ã€‚  
dict ã‹ã‚‰ã®ã‚³ãƒ³ãƒãƒ¼ã‚¿ãƒ¼ã‚’ç”¨æ„ã—ã¦ã‚‚è‰¯ã„ã€‚  

éŸ³ç´ ä¸€è¦§ã‚„ãƒ¢ãƒ¼ãƒ©éŸ³ç´ ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ SpeechTree ä»•æ§˜ã«å…¥ã‚Œã‚‹ã¨ã€ã“ã‚Œã‚ˆã‚Šåºƒã„å€¤ã‚’å–ã‚Œãªããªã‚‹ã€‚  
ä»Šã®ãƒ•ãƒ«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ©ãƒ™ãƒ«ãŒè¡¨å±¤å½¢ã‚„ãƒ¢ãƒ¼ãƒ©ç¨®åˆ¥ã«ä¸è¶³ãŒã‚ã‚‹ã®ã¨åŒã˜æ§‹å›³ã«ãªã‚‹ï¼ˆè¡¨å±¤å½¢ã¯ç¨®åˆ¥ã¨ã„ã†ã‚ˆã‚Šå±æ€§ã”ã¨ãªã„ã®ã§ã¡ã‚‡ã£ã¨é•ã†ã‘ã©ï¼‰ã€‚  
ãã®ãŸã‚ standard validator/mapper ã ã‘ç”¨æ„ã—ã¦ã€ä»•æ§˜ã¨ã—ã¦ã¯ä»»æ„ã«ã—ã¦ãŠãã®ãŒã¾ã‚‹ãã†ã€‚Mecab ã®ãªã‚“ã§ã‚‚ã¤ã‘ã‚Œã‚‹ã®ã¨ä¼¼ãŸæ„Ÿã˜ã€‚  

OJT ã‹ã‚‰å–ã‚Šè¾¼ã‚€æƒ…å ±ã¨ãã®æ ¹æ‹ :
  - string: èª­ã¿ä¸Šã’ãŸã„æ›¸ãæ–‡å­—ãƒ†ã‚­ã‚¹ãƒˆã§ã‚ã‚Šã€åŸæ–‡ã®æƒ…å ±ã¨ã—ã¦å¿…è¦ã€‚
  - pron: èª­ã¿ä¸Šã’ã‚‹ã¨ãã®éŸ³ã®ç¨®é¡ã§ã‚ã‚Šã€ä¸»è¦ãªéŸ³å£°æƒ…å ±ã¨ã—ã¦å¿…è¦ã€‚ãªãŠã€string ã‹ã‚‰ç°¡å˜ã«ã¯ã‚ã‹ã‚‰ãªã„ã€‚
  - acc: èª­ã¿ä¸Šã’ã‚‹ã¨ãã®éŸ³ã®é«˜ã•ã§ã‚ã‚Šã€ä¸»è¦ãªéŸ³å£°æƒ…å ±ã¨ã—ã¦å¿…è¦ã€‚ãªãŠã€string ã‹ã‚‰ç°¡å˜ã«ã¯ã‚ã‹ã‚‰ãªã„ã€‚
  - chain_flag: ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥åŒ–ã®æŒ‡ç¤ºã§ã‚ã‚Šã€ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥ã¸ã®æ§‹é€ åŒ–ã«å¿…è¦ã€‚ãªãŠã€æœ€çµ‚çš„ã«ã¯ãƒ•ãƒ©ã‚°å€¤ã¨ã—ã¦ã¯ä¸è¦ã€‚

#### Tree design
##### åŸºæœ¬æ–¹é‡ï¼šã€Œä¸è¶³ã¨é‡è¤‡ã‚’ãªãã™ã€  
æ—¢å­˜è¦æ ¼ã®ä»£è¡¨ä¾‹ã§ã‚ã‚‹ãƒ•ãƒ«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ©ãƒ™ãƒ«ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆã¨ãƒ¢ãƒ¼ãƒ©ç™ºéŸ³ãŒä¸è¶³ã—ã¦ã„ã‚‹ã€‚  
ã“ã‚Œã«ã‚ˆã‚Šæ„å›³ã—ãªã„éŸ³ç´ ãŒä½•ã«ç”±æ¥ã™ã‚‹ã‹ï¼ˆã©ã®ãƒ¯ãƒ¼ãƒ‰ã‹ã€ã©ã®ãƒ¢ãƒ¼ãƒ©ã‹ï¼‰ãŒã‚ã‹ã‚‰ãªã„ã€‚  
ã“ã‚Œã‚‰ã‚’é‘‘ã¿ã€SpeechTree ã§ã¯åŸºæœ¬æ–¹é‡ã®ã²ã¨ã¤ã«ã€Œä¸è¶³ã‚’ãªãã™ã€ã‚’æ¡ç”¨ã™ã‚‹ã€‚  

å±æ€§ã®é‡è¤‡ã¯ç·¨é›†ã‚’é›£ã—ãã™ã‚‹ã€‚ãªãœãªã‚‰1ç®‡æ‰€ã®ç·¨é›†ãŒé‡è¤‡ç®‡æ‰€ã®ç·¨é›†ã‚’è¦æ±‚ã™ã‚‹ã‹ã‚‰ã§ã‚ã‚‹ã€‚  
ã‚¯ãƒ©ã‚¹ã§ã‚ã‚Œã°ã‚»ãƒƒã‚¿ãƒ¼ã«åŒæœŸæ©Ÿèƒ½ã‚’æŒãŸã›ã¦ç·©å’Œã§ãã‚‹ãŒã€æ§‹é€ ä½“ã§ã¯ãã†ã¯ã„ã‹ãªã„ã€‚  
SpeechTree ã¯ editable TTS å‘ã‘ã§ã‚ã‚Šã€ç·¨é›†ã‚’å‰æã¨ã—ã¦ã„ã‚‹ã€‚ã¾ãŸè¤‡æ•°ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§å–ã‚Šå›ã™å‰æã§ã‚ã‚Šã€æ§‹é€ ä½“ãŒå¥½ã¾ã—ã„ã€‚  
ã“ã‚Œã‚‰ã‚’é‘‘ã¿ã€SpeechTree ã§ã¯åŸºæœ¬æ–¹é‡ã®ã²ã¨ã¤ã«ã€Œé‡è¤‡ã‚’ãªãã™ã€ã‚’æ¡ç”¨ã—ãŸã€‚  

##### éšå±¤ã®æ ¹æ‹ 
SpeechTree ã¯æ—¥æœ¬èªæ¨™æº–èªãŒç¬¬ä¸€è¨€èªã§ã‚ã‚‹ã€‚ãã®ãŸã‚é«˜ä½ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã¨ãƒ¢ãƒ¼ãƒ©ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã€‚  

é«˜ä½ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã¯ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥ã®æ¦‚å¿µã‚’å°ãã€ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥ã«ã¯ã¡ã‚‡ã†ã©1ã¤ã®ã‚¢ã‚¯ã‚»ãƒ³ãƒˆãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€‚ãã®ãŸã‚ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥ãŒéšå±¤ã®ã²ã¨ã¤ã«ãªã‚‹ã€‚  
ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥ã¯ãƒ†ã‚­ã‚¹ãƒˆã«ã‚ˆã‚‰ãªã„ã€ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã®ä½ç½®ã¨ã„ã†æ¦‚å¿µã‚’æ‰±ã†ã€‚ãã®ãŸã‚ãƒ†ã‚­ã‚¹ãƒˆã¯ä¸‹ä½éšå±¤ã§æ‰±ã‚ã‚Œã‚‹ã€‚  

ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥ã‚’æ§‹æˆã™ã‚‹èªï¼ˆãƒ¯ãƒ¼ãƒ‰ï¼‰ã¯ãƒ†ã‚­ã‚¹ãƒˆã«å¯¾å¿œã—ã¦ã„ã‚‹ãŸã‚ã€ãƒ¯ãƒ¼ãƒ‰ãŒéšå±¤ã®ã²ã¨ã¤ã«ãªã‚‹ã€‚  
ãƒ¯ãƒ¼ãƒ‰ã®ç™ºéŸ³ã¯ãƒ†ã‚­ã‚¹ãƒˆã®è¦å‰‡çš„ãªå¤‰æ›ã§ã¯å¾—ã‚‰ã‚Œãªã„ã€‚ã¤ã¾ã‚Šãƒ†ã‚­ã‚¹ãƒˆã¨ç™ºéŸ³ã¯é‡è¤‡ã—ã¦ã„ãªã„ã€‚  

ä¸€èˆ¬çš„ãªæ—¥æœ¬èªè©±è€…ã¯ç™ºéŸ³ã‚’50éŸ³çš„ãƒ»ã‚«ã‚¿ã‚«ãƒŠçš„ã«æ‰±ã†ã€‚ã‹ã¤ã€éŸ³ã®é•·ã•ãƒ»æ‹ã§éŸ³ã®æ•°ã‚’æ•°ãˆã‚‹ã€‚ã™ãªã‚ã¡ç™ºéŸ³ã¯ãƒ¢ãƒ¼ãƒ©ãŒå˜ä½ã«ãªã£ã¦ã„ã‚‹ã€‚  
è¤‡æ•°ã®ãƒ¢ãƒ¼ãƒ©ãŒé›†ã¾ã£ã¦ãƒ¯ãƒ¼ãƒ‰ã®ç™ºéŸ³ã‚’æ§‹æˆã™ã‚‹ãŸã‚ã€ãƒ¢ãƒ¼ãƒ©ãŒéšå±¤ã®ã²ã¨ã¤ã«ãªã‚Šã€ãã‚Œã¯ãƒ¯ãƒ¼ãƒ‰ã®ä¸‹ã«ãªã‚‹ã€‚  

ãƒ¢ãƒ¼ãƒ©ã¯1ã¤ä»¥ä¸Šã®éŸ³ç´ ã‹ã‚‰ãªã‚‹ã€‚  
éŸ³ç´ ã¯è¨€èªã”ã¨ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚ã—ã‹ã—æ—¥æœ¬èªã®éŸ³ç´ ã®ç¨®é¡ã¯æœªã ç ”ç©¶é€”ä¸Šã«ã‚ã‚Šã€åˆ†é¡ã«ã‚‚è¤‡æ•°ã®èª¬ãŒã‚ã‚‹ã€‚  
ãƒ¢ãƒ¼ãƒ©ã¨éŸ³ç´ ã®å¯¾å¿œé–¢ä¿‚ã‚‚åŒæ§˜ã§ã€åŒã˜ãƒ¢ãƒ¼ãƒ©ãŒç•°ãªã‚‹éŸ³ç´ ã¸ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚‹ã€‚  
ã“ã‚Œã«ã‚ˆã‚ŠéŸ³ç´ ã¯ãƒ¢ãƒ¼ãƒ©ã®è¦å‰‡çš„ãªå¤‰æ›ã§ã¯å¾—ã‚‰ã‚Œãªã„ã€‚ã¤ã¾ã‚Šãƒ¢ãƒ¼ãƒ©ã¨éŸ³ç´ ã¯é‡è¤‡ã—ã¦ã„ãªã„ã€‚  
ã‚ˆã£ã¦éŸ³ç´ ãŒéšå±¤ã®ã²ã¨ã¤ã«ãªã‚Šã€ãã‚Œã¯ãƒ¢ãƒ¼ãƒ©ã®ä¸‹ã«ãªã‚‹ã€‚  

è©±è€…ã«ä¾å­˜ã—ãªã„éŸ³ã®ç‰¹å¾´ã«ã€ç„¡å£°åŒ–ï¼ˆ â‰  ç„¡å£°éŸ³ï¼‰ãŒã‚ã‚‹ã€‚  
ä¸€èˆ¬çš„ãªæ—¥æœ¬èªè©±è€…ã¯æ„è­˜ã›ãšã«æ±ºã¾ã£ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç„¡å£°åŒ–ã‚’ãŠã“ãªã†ã€‚ãã®ãŸã‚ç™ºéŸ³ã‚’ã‚«ã‚¿ã‚«ãƒŠè¡¨è¨˜ã•ã›ã¦ã‚‚ç„¡å£°åŒ–ã¯è¨˜è¿°ã•ã‚Œãªã„ãŒã€å®Ÿéš›ã®ç™ºéŸ³ã§ã¯ç„¡å£°åŒ–ãŒèµ·ãã¦ã„ã‚‹ã€‚  
ãã®ãŸã‚ç„¡å£°åŒ–ã¯ç™ºéŸ³ã‚ˆã‚Šä¸‹ã€ã™ãªã‚ã¡ãƒ¢ãƒ¼ãƒ©ã‚ˆã‚Šä¸‹ãŒé©åˆ‡ã§ã‚ã‚‹ã€‚  
ç„¡å£°åŒ–ã¯éŸ³ç´ ã®å˜ä½ã§ãŠãã¦ã„ã‚‹ãŸã‚ã€éŸ³ç´ ã®éšå±¤ã«é…ç½®ã•ã‚Œã‚‹ã¹ãæƒ…å ±ã§ã‚ã‚‹ã€‚ãã®ãŸã‚ç„¡å£°åŒ–ã¯éšå±¤ã¯ã¤ãã‚‰ãšã€éŸ³ç´ ã®å±æ€§ã¨ã™ã‚‹ã®ãŒè‰¯ã„ã€‚  

ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥ã‚ˆã‚Šä¸Šã®éšå±¤ã«ç€ç›®ã™ã‚‹ã¨ã€ä¸€æ¯ã®åŒºåˆ‡ã‚ŠãŒã‚ã‚‹ã€‚  
ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥ã¯è¤‡æ•°ã‚’ã²ã¨ç¶šãã¨ã—ã¦ä¸€æ¯ã§ç™ºå£°ã•ã‚Œã†ã‚‹ã€‚ã¤ã¾ã‚Šã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥ã¯ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ã¤ãã‚‹ã€‚ãã®ãŸã‚ãƒ–ãƒ¬ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ãŒéšå±¤ã®ã²ã¨ã¤ã«ãªã‚‹ã€‚    
ãƒ–ãƒ¬ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ã®å®šç¾©ã«ã‚ˆã‚Šã€ãƒ–ãƒ¬ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒ–ãƒ¬ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆ= ä¸€æ¯ã¨ä¸€æ¯ã®é–“ï¼‰ã«ã¯ç™ºå£°ã‚’ä¼´ã‚ãªã„åŒºé–“ãŒã‚ã‚‹ã€‚  
ã“ã®åŒºé–“ã¯ä¸€ç¨®é¡ã®å˜ãªã‚‹ç„¡éŸ³ã§ã¯ãªãã€è¤‡æ•°ç¨®é¡ãŒå­˜åœ¨ã—ã‹ã¤è¤‡æ•°å€‹ãŒé€£ç¶šã—ã¦å­˜åœ¨ã§ãã€ãƒ–ãƒ¬ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ã®ç™ºå£°æ–¹æ³•ã¸ã‚‚å½±éŸ¿ã‚’ä¸ãˆã‚‹ã€‚  
ãƒ†ã‚­ã‚¹ãƒˆã§è¡¨ç¾ã™ã‚Œã°ã€Œã€ã€ã€Œã€‚ã€ã€Œï¼Ÿã€ã€Œï¼ã€ã€Œã€ã€ã€Œã€€ã€ã€Œã€ãªã©æ§˜ã€…ã§ã‚ã‚Šã€ç´„ç‰©ã¨ç·ç§°ã•ã‚Œã‚‹ã€‚  
ã²ã¨ç¶šãã®å½¹ç‰©ã‚’ãƒãƒ¼ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã¿ãªã›ã°ã€æ–‡ã¯ãƒ–ãƒ¬ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ã¨ãƒãƒ¼ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ãŒäº¤ä»£ã§ä¸¦ã¶ã‚‚ã®ã¨ã¿ãªã›ã‚‹ã€‚  
å½¹ç‰©ã¯ç„¡éŸ³ã§ã‚ã‚‹ãŸã‚ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚’æŒãŸãšå˜ä¸€ã®ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥ã«å±ã—ã€å„å½¹ç‰©ã¯ãã‚Œãã‚Œç‹¬ç«‹ã—ã¦ã„ã‚‹ã®ã§åˆ¥ã€…ã®ãƒ¯ãƒ¼ãƒ‰ã¨ã¿ãªã›ã‚‹ã€‚  
ç„¡éŸ³ã§ã‚ã‚‹ãŸã‚ã©ã‚Œã‚‚ãƒ¢ãƒ¼ãƒ©ç™ºéŸ³ã¯ã€Œã€€ã€éŸ³ç´ ã¯ã€Œpauã€ã¨ã™ã‚Œã°ã€ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥ã¯ãƒ–ãƒ¬ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ä¸‹ã®ã‚‚ã®ã¨å…¨ãåŒã˜æ§‹é€ ã«ãªã‚‹ã€‚  
ã‚ˆã£ã¦ãƒãƒ¼ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ã¯éšå±¤ã®ã²ã¨ã¤ã¨ãªã‚Šã€ãƒ–ãƒ¬ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ã¨åŒã˜ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã™ã‚‹å…„å¼Ÿã«ãªã‚‹ã€‚  

ã‚°ãƒ«ãƒ¼ãƒ—ã®åˆ—ãŒæ–‡ã§ã‚ã‚Šã€æœ€çµ‚ãƒ¬ãƒ™ãƒ«ã§ã‚ã‚‹ã€‚  
é ‚ç‚¹ã®ãƒãƒ¼ãƒ‰ã«ä»˜ä¸ã™ã‚‹æƒ…å ±ãŒãªã„ãŸã‚ã€é ‚ç‚¹ãƒãƒ¼ãƒ‰ã‚’æš—ç¤ºçš„ãªã‚‚ã®ã¨ã—ã¦ã‚°ãƒ«ãƒ¼ãƒ—åˆ—ã®å‹ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ Tree ã¨å‘¼ã¶ã€‚  


#### History
- ç€æƒ³ ver1ï¼šã€Œãƒ•ãƒ«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ©ãƒ™ãƒ«ãŒã¾ã©ã‚ã£ã“ã—ã„ã€
- ç€æƒ³ ver2ï¼šã€Œ`make_label()` ã®å‡¦ç†å†…å®¹ãŒã±ã£ã¨è¦‹ã§ã‚ã‹ã‚‰ãªã™ãã‚‹ã€
- ç€æƒ³ ver3ï¼šã€Œãƒ•ãƒ«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ©ãƒ™ãƒ«ã¯æƒ…å ±ãŒä¸è¶³ã—ã¦ã‚‹æ°—ãŒã™ã‚‹ã€
- ç€æƒ³ ver4ï¼šã€ŒJPCommon ã¸ã®å¤‰æ›æ™‚ã«æƒ…å ±è½ã¨ã—ã™ãã¦ã„ã‚‹ã€
- ç€æƒ³ ver5ï¼šã€Œã‚‚ã†å°‘ã—ãƒªãƒƒãƒãªä¸­é–“è¡¨ç¾ãŒ TTS ã«ã¯å¿…è¦ãªã®ã§ã¯ï¼Ÿã€

#### Notes
æœ¨æ§‹é€  tree  
éŸ³å£°çš„  
å€‹åˆ¥ãƒ¢ãƒ¼ãƒ©ã®ãƒ”ãƒƒãƒã¯æŒãŸãšã€ã‚¢ã‚¯ã‚»ãƒ³ãƒˆå¥ã®ã¿ã€‚  
â†’ voice ä¸€èˆ¬ï¼ˆâˆ‹ æ­Œå£°ï¼‰ã§ã¯ãªãã€speech å¯„ã‚Šã€‚  

# speech_tree = sorted(list(set(MR_CV.keys())))
# voicevox = sorted(list(set(map(lambda s: s[0], vv_mapping))))
# ojt_vv_diff_phonemes = ['ã‚¦ã‚¥', 'ã‚­ã‚£', 'ã‚®ã‚£', 'ã‚¯ã‚¡', 'ã‚¯ã‚£', 'ã‚¯ã‚¥', 'ã‚¯ã‚§', 'ã‚¯ã‚©', 'ã‚°ã‚¡', 'ã‚°ã‚£', 'ã‚°ã‚¥', 'ã‚°ã‚§', 'ã‚°ã‚©', 'ãƒ‚ã‚§', 'ãƒ‚ãƒ£', 'ãƒ‚ãƒ¥', 'ãƒ‚ãƒ§', 'ãƒ†ã‚§', 'ãƒ‡ã‚§', 'ãƒ‹ã‚£', 'ãƒ’ã‚£', 'ãƒ“ã‚£', 'ãƒ”ã‚£', 'ãƒŸã‚£', 'ãƒªã‚£', ]
# diff_s = list(filter(lambda s: s[0] in ojt_vv_diff_phonemes, vv_mapping))
# ojt_vv_diff_sets = [('ãƒªã‚£', 'ry', 'i'), ('ãƒŸã‚£', 'my', 'i'), ('ãƒ”ã‚£', 'py', 'i'), ('ãƒ“ã‚£', 'by', 'i'), ('ãƒ’ã‚£', 'hy', 'i'), ('ãƒ‹ã‚£', 'ny', 'i'), ('ãƒ‡ã‚§', 'dy', 'e'), ('ãƒ†ã‚§', 'ty', 'e'), ('ã‚°ã‚©', 'gw', 'o'), ('ã‚°ã‚§', 'gw', 'e'), ('ã‚°ã‚¥', 'gw', 'u'), ('ã‚°ã‚£', 'gw', 'i'), ('ã‚¯ã‚©', 'kw', 'o'), ('ã‚¯ã‚§', 'kw', 'e'), ('ã‚¯ã‚¥', 'kw', 'u'), ('ã‚¯ã‚£', 'kw', 'i'), ('ã‚®ã‚£', 'gy', 'i'), ('ã‚­ã‚£', 'ky', 'i'), ('ã‚¦ã‚¥', 'w', 'u'), ('ãƒ‚ãƒ§', 'j', 'o'), ('ãƒ‚ãƒ¥', 'j', 'u'), ('ãƒ‚ãƒ£', 'j', 'a'), ('ãƒ‚ã‚§', 'j', 'e'), ('ã‚°ã‚¡', 'gw', 'a'), ('ã‚¯ã‚¡', 'kw', 'a')]



Tree  Gardener

Tree ã¯æœ¨æ§‹é€ ã‚’å®šç¾©ã™ã‚‹ã ã‘ã€‚  
Gardener ãŒ validation ã‚„ placement ã‚’æä¾›ã€‚  
å˜ãªã‚‹é–¢æ•°ã§ã¯ãªã class ã«ã™ã‚‹ã“ã¨ã§ã€param ã‚’å—ã‘å…¥ã‚Œã¦æ©Ÿèƒ½ã‚’å¤‰ãˆã‚‰ã‚Œã‚‹ã€‚  
char set ã¨ã‹ã‚’å¤‰ãˆã‚‹ã“ã¨ã§ä¸Šæ‰‹ã validation ã§ãã‚‹ã€‚  

parser ãŒå„å…¥åŠ›å‘ã‘ã® Tree è£½é€ æ©Ÿã€‚  
converter ãŒå„å‡ºåŠ›å‘ã‘ã® Tree æ¶ˆè²»æ©Ÿã€‚  

Gardener.trim_head_tail_marks(tree: Tree) -> Tree:
  if tree.groups[0] is instanceof(MarkGroup):
    tree.groups = tree.groups[1:]
  if tree.groups[1] is instanceof(MarkGroup):
    tree.groups = tree.groups[:-1]

